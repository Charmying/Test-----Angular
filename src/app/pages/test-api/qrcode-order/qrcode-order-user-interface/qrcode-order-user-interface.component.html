<app-header></app-header>

<app-test-api-header></app-test-api-header>

<app-section class="relative">
  <div class="text-h1">QR Code 點餐系統前台</div>
  
  <!-- 桌號輸入底部彈窗 -->
  <div *ngIf="showTableNumber" class="fixed inset-0 z-10">
    <!-- 遮罩 -->
    <div class="absolute inset-0 bg-black bg-opacity-50"></div>
    <!-- 底部輸入桌號彈窗 -->
    <div class="absolute inset-x-0 bottom-0 transform transition-transform duration-300 translate-y-0">
      <div class="bg-white p-8">
        <app-form-input-text [form]="form" [title]="'請先輸入桌號：'" [type]="'text'" [formControlName]="'tableNumber'" [placeHolder]="'請輸入桌號'"></app-form-input-text>
        <app-button class="block mt-4 text-right" [text]="'確認桌號'" (buttonClick)="confirmTableNumber()"></app-button>
      </div>
    </div>
  </div>

  <!-- 菜單列表 -->
  <div class="my-16">
    <div class="text-h2 my-4">菜單：</div>
    <div class="border-2 border-solid border-black rounded-lg p-4 mb-4 leading-loose" *ngFor="let item of menuItems">
      <div class="flex justify-between">
        <div class="self-center">
          <img [src]="item.photo" alt="menu photo" class="w-28 h-28 object-cover rounded-md" />
        </div>
        <div class="relative">
          <div class="text-body1 text-end">{{ item.name }}</div>
          <div class="text-body1 text-end">＄{{ item.price }}</div>
          <app-button class="block text-end absolute bottom-0 right-0" [text]="'加入訂單'" (buttonClick)="addToOrder(item)"></app-button>
        </div>
      </div>
    </div>
  </div>

  <!-- 餐點加入訂單成功的彈出提示 -->
  <div *ngIf="showSuccessToast" [class]="'fixed top-0 left-0 w-full bg-yellow-400 text-center px-4 py-3 shadow-md z-10 transition-all duration-500 ease-in-out ' + (toastVisible ? 'translate-y-0 opacity-100' : '-translate-y-full opacity-0')">{{ successMessage }}</div>

  <!-- 確認當前餐點訂單按鈕 -->
  <div *ngIf="currentOrder.length">
    <div class="text-body1 bg-yellow-400 text-center px-6 py-2 fixed inset-x-0 bottom-0 transform transition-transform duration-300 translate-y-0 cursor-pointer" (click)="openConfirmModal()">
      <div class="flex justify-between">
        <div class="text-body1 self-center">確認餐點</div>
        <div class="text-body1 border border-solid border-black p-1">{{ totalQuantity }}</div>
      </div>
    </div>
  </div>

  <!-- 餐點訂單彈窗 -->
  <div *ngIf="showConfirmOrder" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-10">
    <div class="bg-white rounded-xl p-6 w-11/12">
      <div class="text-h2 mb-4">當前餐點確認</div>
      <div *ngFor="let item of currentOrder" class="flex justify-between py-2 border-b border-gray-200">
        <span class="text-body1">{{ item.name }} x{{ item.quantity }}</span>
        <span class="text-body1">＄{{ item.price * item.quantity }}</span>
      </div>
      <div class="flex justify-between py-4 border-t border-gray-400 font-bold text-body1 mt-4">
        <span class="text-body1">總金額</span>
        <span class="text-body1">＄{{ totalAmount }}</span>
      </div>
      <div class="flex justify-end mt-6 space-x-4">
        <app-button [text]="'繼續點餐'" (buttonClick)="closeConfirmModal()"></app-button>
        <app-button [text]="'確定送出'" (buttonClick)="submitOrder()"></app-button>
      </div>
    </div>
  </div>
</app-section>
